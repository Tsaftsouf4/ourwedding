<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Πρόσκληση Γάμου</title>

<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{width:100%;height:100%;overflow:hidden;background:#f6ead8;font-family:serif}

:root{
  --pageAspect: 1.45;     /* height / width */
  --pageShadow: 0 18px 40px rgba(0,0,0,.25);
  --radius: 22px;
}

.wrapper{
  width:100vw;height:100svh;
  display:flex;align-items:center;justify-content:center;
  position:relative;
}

/* BOOK AREA */
.book{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:28px;
  will-change: transform;
}

/* PAGE */
.page{
  background:transparent;
  box-shadow: var(--pageShadow);
  border-radius: var(--radius);
  overflow:hidden;
  transform-style: preserve-3d;
}

.page img{
  width:100%;height:100%;
  object-fit: contain;
  display:block;
}

/* NAV */
.nav{
  position:absolute;
  bottom:26px;
  display:flex;
  gap:14px;
  z-index:10;
}
button{
  background: rgba(255,255,255,.65);
  border:none;
  padding:10px 18px;
  border-radius:999px;
  font-size:14px;
  cursor:pointer;
  backdrop-filter: blur(6px);
}

/* ===== FLIP ANIMATION ===== */
@keyframes pageFlip {
  0%   { transform: perspective(1200px) rotateY(0deg) translateZ(0); }
  40%  { transform: perspective(1200px) rotateY(-18deg) translateZ(1px); }
  100% { transform: perspective(1200px) rotateY(0deg) translateZ(0); }
}
.flip-anim .page{
  animation: pageFlip .38s cubic-bezier(.2,.8,.2,1);
}

/* MOBILE: μία σελίδα, κεντρικά, μεγάλη αλλά ποτέ κομμένη */
@media (max-width: 900px){
  .book{ flex-direction: column; gap: 0; }
  .page{
    width: min(92vw, calc((100svh - 200px) / var(--pageAspect)));
    height: calc(
      min(92vw, calc((100svh - 200px) / var(--pageAspect))) * var(--pageAspect)
    );
  }
  .hide-mobile{ display:none !important; }
}

/* DESKTOP: όπως πριν -> cover μόνο, μετά διπλή σελίδα */
@media (min-width: 901px){
  .page{
    width: min(38vw, 420px);
    height: calc(min(38vw, 420px) * var(--pageAspect));
  }
  .hide-desktop{ display:none !important; }
}
</style>
</head>

<body>
<div class="wrapper">

  <div class="book" id="book">
    <!-- 1 Cover -->
    <div class="page" id="p0"><img src="assets/cover.png" alt="Cover"></div>

    <!-- 2 Left -->
    <div class="page" id="p1"><img src="assets/left.png" alt="Ο γάμος μας"></div>

    <!-- 3 Right -->
    <div class="page" id="p2"><img src="assets/right.png" alt="Η ημέρα μας"></div>
  </div>

  <div class="nav">
    <button id="btnPrev" onclick="prev()">◀ Πίσω</button>
    <button id="btnNext" onclick="next()">Μπροστά ▶</button>
  </div>

</div>

<audio id="flipSound" src="assets/flip.mp3" preload="auto"></audio>

<script>
const book  = document.getElementById('book');
const pages = [document.getElementById('p0'), document.getElementById('p1'), document.getElementById('p2')];
const sound = document.getElementById('flipSound');

let indexMobile = 0;  // 0->1->2
let indexDesktop = 0; // 0 = cover μόνο, 1 = διπλή σελίδα (left+right)

function isMobile(){ return window.innerWidth <= 900; }

function playFlip(){
  // πιο γρήγορο/σφιχτό flip sound
  sound.currentTime = 0;
  sound.playbackRate = 1.35;
  sound.play().catch(()=>{});
}

function animateFlip(){
  book.classList.remove('flip-anim');
  // force reflow
  void book.offsetWidth;
  book.classList.add('flip-anim');
  setTimeout(()=>book.classList.remove('flip-anim'), 420);
}

function setVisibility(){
  // reset
  pages.forEach(p=>{
    p.classList.remove('hide-mobile','hide-desktop');
  });

  if (isMobile()){
    // mobile: δείξε μόνο 1 σελίδα (indexMobile)
    pages.forEach((p,i)=>{
      if (i !== indexMobile) p.classList.add('hide-mobile');
    });
  } else {
    // desktop: όπως πριν
    // indexDesktop=0 -> cover μόνο
    // indexDesktop=1 -> left+right (διπλή)
    if (indexDesktop === 0){
      pages[1].classList.add('hide-desktop');
      pages[2].classList.add('hide-desktop');
    } else {
      pages[0].classList.add('hide-desktop');
      // left+right visible
    }
  }
}

function next(){
  if (isMobile()){
    if (indexMobile < 2){
      indexMobile++;
      playFlip(); animateFlip(); setVisibility();
    }
  } else {
    if (indexDesktop < 1){
      indexDesktop = 1;
      playFlip(); animateFlip(); setVisibility();
    }
  }
}

function prev(){
  if (isMobile()){
    if (indexMobile > 0){
      indexMobile--;
      playFlip(); animateFlip(); setVisibility();
    }
  } else {
    if (indexDesktop > 0){
      indexDesktop = 0;
      playFlip(); animateFlip(); setVisibility();
    }
  }
}

window.addEventListener('resize', ()=>{
  // όταν αλλάζει mode, κράτα λογική θέση:
  // αν πας σε desktop -> αν είσαι σε left/right, πήγαινε στη διπλή
  if (!isMobile()){
    indexDesktop = (indexMobile === 0) ? 0 : 1;
  } else {
    indexMobile = (indexDesktop === 0) ? 0 : 1; // στη mobile ξεκίνα από left όταν είσαι σε spread
  }
  setVisibility();
});

setVisibility();
</script>
</body>
</html>
